<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">

    <title>The Ultimate Marvel Books Tinder</title>

</head>

<body style="height: 100vh">
    <div>
        <input type="image" id="iron-man-image" class="rounded mx-auto d-block" src="banner.png" width="500"
            height="400" />
    </div>
    <div>
        <p class="fs-1 text text-center fw-bolder">Book Match<input id="h-search text-center"
                class="btn btn-danger ms-3 text-center fs-4 fw-bolder" value="Procurar"
                onclick="getDataFromGoogleBookApi()" readonly></p>
    </div>
    <div id="container text-center">
        <div id=content class="text-center">
            <div class="row">
                <div class="col-3">
                    <label class="col-2 text-center fs-4 fw-bolder bg-danger text-white" for="iron-man-image"
                        style="height:50px;width:400px;">Click Iron Man to save the book</label><br><br>
                    <input type="image" id="iron-man-image" src="iron-man.png" width="500" height="400"
                        onclick="likeBook()" />
                    <p id="MyLib" class="fs-3 text"></p>
                </div>
                <div id="infoGoogle" class="col-6 fs-3 text">
                    <img id="frontPage" src=""><br>
                    <p id="Title"></p>
                    <p id="Language"></p>
                    <p id="Date"></p>
                    <p id="Author"></p>
                    <p id="Pages"></p>
                    <p id="Language"></p>
                    <p id="Description"></p>
                </div>
                <div class="col-3">
                    <label class="col-2 text-center fs-4 text fw-bolder bg-danger text-white" for="thanos-image"
                        style="height:50px;width:400px;">Click Thanos to snap the book</label>
                    <input type="image" id="thanos-image" src="thanos.png" width="500" height="400"
                        onclick="dislikeBook () " onclick="move('right')" />
                    <p id="ThanosLib" class="fs-3 text"></p>
                </div>
            </div>
        </div>
    </div>

    <input type="image" id="gaunt-image" class="rounded mx-auto d-block" src="infinity-gauntlet.png"
        onclick="restartBooks()" width="500" height="400" />
    <p class="fs-3 fw-bolder text-center ">Use the gauntlet to snap libraries</p>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <script>

        class Book {
            constructor(googleTitle, googlePubDate, googlePageCount, googleLanguage, googleAuthor, googleImage, googleInfo, googleDescription) {
                this.title = googleTitle;
                this.publishedDate = googlePubDate;
                this.pageCount = googlePageCount;
                this.language = googleLanguage;
                this.authors = googleAuthor;
                this.image = googleImage;
                this.infoLink = googleInfo;
                this.description = googleDescription;

            }
        }
        let books = [];
        let startIndex = 40;
        let maxResults = 40;


        function getDataFromGoogleBookApi() {
            $.get(`https://www.googleapis.com/books/v1/volumes?q='Marvel'&maxResults=${maxResults}&startIndex=${startIndex}`)
                .done((googleData) => {
                    startIndex += maxResults;
                    prepareData(googleData.items)
                    addBook()
                })
                .fail((googleError) => {
                    console.log(googleError);
                })
        }

        function prepareData(googleData) {
            for (const element of googleData) {
                console.log(element);
                let noImage = "No_Image_Available.jpg";
                if (element.volumeInfo.imageLinks && element.volumeInfo.imageLinks.thumbnail) {
                    noImage = element.volumeInfo.imageLinks.thumbnail;
                }
                let book = new Book(
                    element.volumeInfo.title,
                    element.volumeInfo.publishedDate,
                    element.volumeInfo.pageCount,
                    element.volumeInfo.language,
                    element.volumeInfo.authors,
                    noImage,
                    element.volumeInfo.infoLink,
                    element.volumeInfo.description
                )
                console.log(book);
                books.push(book);
            }
            for (const book of books) {
                console.log(book);
            }
        }

        function addBook() {
            let addBooks = books[0];
            $("#Title").html("<b>Title: </b>" + addBooks.title);
            $("#Language").html("<b>Language: </b>" + addBooks.language);
            $("#Date").html("<b>Published Date: </b>" + addBooks.publishedDate);
            $("#Author").html("<b>Author(s): </b>" + addBooks.authors);
            $("#Pages").html("<b>Pages: </b>" + addBooks.pageCount);
            $("#frontPage").attr("src", addBooks.image);
            $("#Link1").attr("href", addBooks.infoLink);
            $("#Description").html("<b>Description: </b>" + addBooks.description);

            console.log(addBooks);
        }

        function likeBook() {
            let addBooks = books.shift();
            addBook();
            books.push(addBooks);
            $("#MyLib").prepend(`<tr><td><b>${addBooks.title}</b></td></tr>`);
        }

        function dislikeBook() { // objectivo do projecto a longo prazo: "criar o Thanos Effect"
            let addBooks = books.shift();
            addBook();
            books.push(addBooks);
            $("#ThanosLib").prepend(`<tr><td><b>${addBooks.title}</b></td></tr>`);
        }

        function restartBooks() {
            $('#ThanosLib').empty();
            $('#MyLib').empty();
        }

    </script>
</body>

</html>